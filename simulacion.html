 <html>
   <head>
   <title>Esta es una pagina web</title>
   <script type="text/javascript">
		var NF1 , NF2, NP1 , NP2, T, NE, STL, STP, M, N, TF ;
		var llegadaPedidoEv = new Object();
		var terminaImpresionEv = new Object();
		var terminaFabricacionEv = new Object();
		var terminaEmpacado1Ev = new Object();
		var terminaEmpacado2Ev = new Object();
		var reposicionPlasticoEv = new Object(); 
		var reposicionLacaEv = new Object();
		var reposicionPinturaEv = new Object();
		var reposicionCajasEv = new Object();		   
		var eventosFuturos = new Array();
		var colaB1F = new Array();
		var colaB2F = new Array();
		var colaB1I = new Array();
		var colaB2I = new Array();
		var colaB1E = new Array();
		var colaB2E = new Array();
		
		

		var maquinaFabricacion = maquinaImpresion = new Object();
		maquinaFabricacion.modulo = 0;
		maquinaFabricacion.configuracionPomo = 'B1';
		maquinaFabricacion.cantTipoConsecutivo = M;
		maquinaFabricacion.numeroCola1 = NF1;
		maquinaFabricacion.numeroCola2 = NF2;

		var maquinaImpresion = new Object();
		maquinaImpresion.modulo = 0;
		maquinaImpresion.tipoPomo = 'B1';
		maquinaImpresion.cantTipoConsecutivo = N;
		maquinaImpresion.numeroCola1 = NI1;
		maquinaImpresion.numeroCola2 = NI2;

		eventosFuturos.push(llegadaPedidoEv,terminaImpresionEv ,terminaFabricacionEv ,terminaEmpacado1Ev ,terminaEmpacado2Ev ,
		reposicionPlasticoEv ,reposicionLacaEv ,reposicionPinturaEv ,reposicionCajasEv);

		llegadaPedidoEv.funcion = llegadaPedido;
		terminaImpresionEv.funcion = terminaImpresion;
		terminaFabricacionEv.funcion = terminaFabricacion;
		terminaEmpacado1Ev.funcion = terminaEmpacado;
		terminaEmpacado2Ev.funcion = terminaEmpacado;
		reposicionPlasticoEv.funcion = reposicionPlastico;
		reposicionLacaEv.funcion = reposicionLaca;
		reposicionPinturaEv.funcion = reposicionPintura;
		reposicionCajasEv.funcion = reposicionCajas;

		eventosFuturos.forEach(function(elemento, indice){elemento.tiempo = 0;});


		function obtenerEventoFuturoProximo() {
		 
			return eventosFuturos.sort(function(a,b){return a.tiempo - b.tiempo})[0];
		}

		function funcion (){
			return 2*2;
		}

		function iniciarSimulacion() {
			
			//srand(time(NULL));
			inicializar();
			simulacion();
		}

		function inicializar(){
		}

		function simulacion(){
			do{
				eventoFuturo = obtenerEventoFuturoProximo()
				eventoFuturo.funcion;
			}
			while(T <= TF);
		}

		function creacionDePedido(){
			pedido = new Object();
			pedido.tipoPomo = obtenerTipoPomo();
			pedido.tamanioPedido = obtenerTamanioPedido();

			return pedido;
		}

		function llegadaPedido(){

			T = llegadaPedido.tiempo;
			llegadaPedido.tiempo = T + getIntervaloPedido();
			unPedido = creacionDePedido();

			if(Math.random() < 0.91)
				llegaPedidoCompleto(unPedido);
			else
				llegaPedidoImpresion(unPedido);
				
		}

		function getIntervaloPedido(){
			return 1; //FDP
		}

		function ubicarEnColaDeFabricacion(unPedido){

			if(unPedido.tipoPomo == 'B1'){
				NF1++;
				colaB1F.push(unPedido);
			}else{
				NF2++;
				colaB2F.push(unPedido);
			}
		}

		function ubicarEnColaDeImpresion(unPedido){

			if(unPedido.tipoPomo == 'B1'){
				NP1++;
				colaB1I.push(unPedido);
			}
			else{
				NP2++;
				colaB2I.push(unPedido);
			}
		}

		function ubicarEnColaDeEmpaque(unPedido){

			if(unPedido.tipoPomo == 'B1'){
				NE1++;
				colaB1E.push(unPedido);
			}
			else{
				NE2++;
				colaB2E.push(unPedido);
			}
		}

		function llegaPedidoCompleto(unPedido){
						
			ubicarEnColaDeFabricacion(unPedido);
			if(NF1 + NF2 == 1){ 
				var demora = obtenerDemoraPreparacion(maquinaFabricacion);

				terminaFabricacion.tiempo = T + demora + obtenerDemoraDeFabricacion(unPedido);
			}
			else{} //calculo de resultados

		}

		function terminaFabricacion(){

			T = terminaFabricacion.tiempo;

			var pedidoParaImpresion = obtenerPedidoTerminadoEnFabricacion();
			ubicarEnColaDeImpresion(pedidoParaImpresion);

			if(NF1 > 0 || NF2 > 0){
				var unPedido = obtenerPedidoParaFabricacion();
				var demora = obtenerDemoraPreparacion(maquinaFabricacion);
				terminaFabricacion.tiempo = T + demora + obtenerDemoraDeFabricacion(unPedido);
			}
				
			if(NP1 + NP2 == 1)

				terminaImpresion.tiempo = T + obtenerDemoraDeImpresion(pedidoParaImpresion);
			
			if(STPL <= SRPL && reposicionPlastico.tiempo == 99999)
				reposicionPlastico.tiempo = T + obtenerDemoraDeRecepcionDePlastico();
			
		}


		function obtenerPedidoTerminadoEnFabricacion(){
			return maquinaFabricacion.tipoPomo == 'B1' ? colaB1F.shift() : colaB2F.shift();

		}

		function llegaPedidoImpresion(unPedido){
			
			ubicarEnColaDeImpresion(unPedido);
			if( NP1 + NP2 == 1){

				var demora = obtenerDemoraPreparacion(maquinaImpresion);

				terminaImpresion.tiempo = T + obtenerDemoraDeImpresion(unPedido);
			}
			else {}//calculo de resultados
			
		}

		function terminaImpresion(){
			T = terminaImpresion.tiempo;
			if(NP1 > 0 || NP2 > 0){
				terminaImpresion.tiempo = T  + obtenerDemoraDeImpresion();
			}
			else {}//no hay m√°s pintado ver que se hace

			if(NE < 2)
				if(terminaEmpacado1 == 99999)
					terminaEmpacado1.tiempo = T + obtenerDemoraDeEmbalado();
				else
					terminaEmpacado2.tiempo = T + obtenerDemoraDeEmbalado();
			
			if(STL <= 20 && reposicionLaca.tiempo == 99999)
				reposicionLaca.tiempo = T + 24*60; 
			
			if(STP <= 5 && reposicionPintura.tiempo == 99999)
				reposicionPintura.tiempo = T + 24*60;
		}

		

		function terminaEmpacado(terminaEmpacado){
			T = terminaEmpacado.tiempo;
			if(NE > 1)
				terminaEmpacado.tiempo = T + obtenerDemoraDeEmbalado();
				
			if(STC <= SRC && reposicionCajas.tiempo == 99999)
				reposicionCajas.tiempo = T + 24*60;				
			
		}

		function reposicionPlastico(){
			STPL = STPL + TPP;
		}

		function reposicionLaca(){
			STL = STL + 20;
		}

		function reposicionPintura(){
			STP = STP + 5;
		}

		function reposicionCajas(){
			STC = STC + TPC;
		}
		function obtenerTipoPomo(){


		}

		function obtenerTamanioPedido(){


		}
		function obtenerDemoraDeEmbalado(){
			//Las tiempos de empaque responden a una fdp en minutos por cada caja a empacar.
		};

		function obtenerDemoraDeFabricacion(){
			//en base a la cantidad de los mismos y su tamanio, tambien hay que tener en cuenta en que formato estaba la maquina configurada.
		};
		function obtenerDemoraDeImpresion(unPedido){
			//el tiempo de pintado mas el secado mas la aplicacion de la laca, 
			//esta dado por una fdp en horas por cada 1000 unidades de pomos, 
			//que es el tamanioo maximo de cada lote de pomos a pintar al mismo tiempo. 
			//tener en cuenta tambien de que tipo es la maquina de impresion y que tipo de pomo se va a imprimir
		};

		function consumoDePlastico(/*tipoPomo, cantidadPomos*/){
			//Estos tamanios determinan la cantidad de gramos de plastico que consume cada pomo.
		};

		function consumoDePintura(/*cantidadPomos*/){
			//El consumo de pintura esta dado por una fdp en gramos para cada lote de 1000
		}

		function consumoDeLaca(/*tipoPomo, cantidadPomos*/){
			//El consumo de laca esta determinado de acuerdo al tamanio del pomo (es un valor fijo por cada lote)
		}

		function obtenerDemoraPreparacion(maquina){
			//comparar con el estado de la maquina. Es lo mismo para fabricacion que para impresion.
			var moduloCorrector = obtenerEstadoMaquina(maquina);
			var demora;

			if(maquina.tipoPomo == 'B1')
				demora = maquina.numeroCola1 > 0 ? 
					obtenerDemoraMismaCola(maquina) : obtenerDemoraDistintaCola(moduloCorrector, maquina);			
			else
				demora = maquina.numeroCola2 > 0 ? 
					obtenerDemoraMismaCola(maquina) : obtenerDemoraDistintaCola(moduloCorrector, maquina);

			return demora;
		}

		function obtenerDemoraPreparacionDeImpresion(){
			var moduloCorrector = obtenerEstadoMaquina();
			var demora;
		}

		function obtenerDemoraMismaCola(maquina){ 
			maquina.modulo++;
		}

		function obtenerDemoraDistintaCola(moduloCorrector, maquina){
			maquina.modulo = moduloCorrector;
			return 4;
		}

		function obtenerPedidoParaFabricacion(){
			var unPedido;

			if(maquinaFabricacion.tipoPomo == 'B1')
				unPedido = NF1 > 0 ? colaB1I[0] : colaB2I[0];

			else
				unPedido = NF2 > 0 ? colaB2I[0] : colaB2I[0];

			return unPedido;
			
		}

		function obtenerEstadoMaquina(maquina){
			var estadoMaquina = new Object();
			if(maquina.modulo % maquina.cantTipoConsecutivo*2 < maquina.cantTipoConsecutivo){
				maquina.tipoPomo = 'B1';
				moduloCorrector = M + 1;
			}
			else{
				maquina.tipoPomo = 'B2';
				moduloCorrector = N + 1;
			}

			return moduloCorrector;

		}


   </script>
   </head>
   <body>
   <script>
           document.write(iniciarSimulacion());
   </script>
   </body>
   </html>
